{"version":3,"file":"static/js/async/src_pages_Index_index_tsx.js","sources":["/home/runner/work/rsbuild-plugin-glsl/rsbuild-plugin-glsl/playground/src/pages/Index/index.module.less","/home/runner/work/rsbuild-plugin-glsl/rsbuild-plugin-glsl/playground/src/hooks/useSyncState.ts","/home/runner/work/rsbuild-plugin-glsl/rsbuild-plugin-glsl/playground/src/pages/Index/index.tsx","/home/runner/work/rsbuild-plugin-glsl/rsbuild-plugin-glsl/playground/src/pages/Index/fs.glsl","/home/runner/work/rsbuild-plugin-glsl/rsbuild-plugin-glsl/playground/src/pages/Index/vs.glsl"],"sourcesContent":["// extracted by css-extract-rspack-plugin\nexport default {\"wrap\":\"src-pages-Index-index-module__wrap-VqkzFA\",\"left\":\"src-pages-Index-index-module__left-yoaSml\",\"canvas\":\"src-pages-Index-index-module__canvas-tb_z9T\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"wrap\\\":\\\"src-pages-Index-index-module__wrap-VqkzFA\\\",\\\"left\\\":\\\"src-pages-Index-index-module__left-yoaSml\\\",\\\"canvas\\\":\\\"src-pages-Index-index-module__canvas-tb_z9T\\\"}\";\n        // 1722442409531\n        var cssReload = require(\"../../../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","import { useState, useRef } from 'react';\nimport type { Dispatch, SetStateAction, MutableRefObject } from 'react';\n\nconst useSyncState = <T>(defaultValue?: T): [T, Dispatch<SetStateAction<T>>, MutableRefObject<T>] => {\n  const refValue = useRef<T>(defaultValue!);\n  const [value, setValue] = useState<T>(defaultValue!);\n\n  const set: Dispatch<SetStateAction<T>> = (v) => {\n    refValue.current = v as T;\n    setValue(v);\n  };\n\n  return [value, set, refValue!];\n};\n\nexport default useSyncState;\n","import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _s = $RefreshSig$();\nimport { useEffect } from 'react';\nimport { useRafLoop } from 'react-use';\nimport useSyncState from '@/hooks/useSyncState';\nimport { WebGLDevice } from '@luma.gl/webgl';\nimport { luma } from '@luma.gl/core';\nimport { Model } from '@luma.gl/engine';\nimport fs from './fs.glsl';\nimport vs from './vs.glsl';\nimport styles from './index.module.less';\nluma.registerDevices([\n    WebGLDevice\n]);\nconst Main = ()=>{\n    _s();\n    const [config, setConfig, configRef] = useSyncState({});\n    const canvasRef = useRef(null);\n    const createRender = async ()=>{\n        const device = await luma.createDevice({\n            type: 'webgl',\n            canvas: canvasRef.current\n        });\n        configRef.current.device = device;\n        configRef.current.positionBuffer = device.createBuffer(new Float32Array([\n            -0.2,\n            -0.2,\n            0.2,\n            -0.2,\n            0.0,\n            0.2\n        ]));\n        configRef.current.colorBuffer = device.createBuffer(new Float32Array([\n            1.0,\n            0.0,\n            0.0,\n            0.0,\n            1.0,\n            0.0,\n            0.0,\n            0.0,\n            1.0,\n            1.0,\n            1.0,\n            0.0\n        ]));\n        configRef.current.offsetBuffer = device.createBuffer(new Float32Array([\n            0.5,\n            0.5,\n            -0.5,\n            0.5,\n            0.5,\n            -0.5,\n            -0.5,\n            -0.5\n        ]));\n        configRef.current.model = new Model(device, {\n            vs,\n            fs,\n            // modules: [colorShaderModule],\n            bufferLayout: [\n                {\n                    name: 'position',\n                    format: 'float32x2'\n                },\n                {\n                    name: 'instanceColor',\n                    format: 'float32x3',\n                    stepMode: 'instance'\n                },\n                {\n                    name: 'instanceOffset',\n                    format: 'float32x2',\n                    stepMode: 'instance'\n                }\n            ],\n            attributes: {\n                position: configRef.current.positionBuffer,\n                instanceColor: configRef.current.colorBuffer,\n                instanceOffset: configRef.current.offsetBuffer\n            },\n            vertexCount: 3,\n            instanceCount: 4\n        });\n    };\n    useRafLoop(()=>{\n        const device = configRef.current.device;\n        if (configRef.current.model && device) {\n            device?.canvasContext?.resize({\n                useDevicePixels: true\n            });\n            device.gl.viewport(0, 0, // @ts-ignore Expose canvasContext\n            device.gl.drawingBufferWidth, // @ts-ignore Expose canvasContext\n            device.gl.drawingBufferHeight);\n            const renderPass = configRef.current.device.beginRenderPass({\n                clearColor: [\n                    0,\n                    0,\n                    0,\n                    1\n                ]\n            });\n            configRef.current.model.draw(renderPass);\n            renderPass.end();\n        }\n    });\n    const destroy = ()=>{\n        configRef.current.model.destroy();\n        configRef.current.positionBuffer.destroy();\n        configRef.current.colorBuffer.destroy();\n        configRef.current.offsetBuffer.destroy();\n    };\n    useEffect(()=>{\n        createRender();\n        return ()=>destroy();\n    });\n    return /*#__PURE__*/ _jsxDEV(\"div\", {\n        className: styles.wrap,\n        children: /*#__PURE__*/ _jsxDEV(\"canvas\", {\n            className: styles.canvas,\n            ref: canvasRef\n        }, void 0, false, {\n            fileName: \"/home/runner/work/rsbuild-plugin-glsl/rsbuild-plugin-glsl/playground/src/pages/Index/index.tsx\",\n            lineNumber: 87,\n            columnNumber: 7\n        }, this)\n    }, void 0, false, {\n        fileName: \"/home/runner/work/rsbuild-plugin-glsl/rsbuild-plugin-glsl/playground/src/pages/Index/index.tsx\",\n        lineNumber: 86,\n        columnNumber: 5\n    }, this);\n};\n_s(Main, \"E6dEy8uAm/rtM8tWAhIrqjGl5as=\", false, function() {\n    return [\n        useSyncState,\n        useRafLoop\n    ];\n});\n_c = Main;\nexport default Main;\nvar _c;\n$RefreshReg$(_c, \"Main\");\n\nfunction $RefreshSig$() {\n  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();\n}\nfunction $RefreshReg$(type, id) {\n  $ReactRefreshRuntime$.register(type, __webpack_module__.id + \"_\" + id);\n}\nPromise.resolve().then(function() {\n  $ReactRefreshRuntime$.refresh(__webpack_module__.id, __webpack_module__.hot);\n});\n","export default \"#version 300 es\\nout vec4 fragColor;\\n\\nin vec3 color_vColor;\\n\\nvec3 color_getColor() {\\n  return color_vColor;\\n}\\n\\nvoid main() {\\n  fragColor = vec4(color_getColor(), 1.0);\\n}\"","export default \"#version 300 es\\nin vec2 position;\\nin vec3 instanceColor;\\nin vec2 instanceOffset;\\n\\nout vec3 color_vColor;\\n\\nvoid color_setColor(vec3 color) {\\n  color_vColor = color;\\n}\\n\\nvoid main() {\\n  color_setColor(instanceColor);\\n  gl_Position = vec4(position + instanceOffset, 0.0, 1.0);\\n}\""],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;ACvBA;AAGA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;ACvJA;;;;;;;;ACAA"}